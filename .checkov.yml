#
# Checkov Security Policy Configuration
#
# This configuration file defines security policies for Terraform code scanning using Checkov.
# Based on CIS AWS Foundations Benchmark and infrastructure governance standards.
# Complements existing tfsec configuration (.tfsec/config.yml)
#
# Usage:
#   checkov -d terraform/ --config-file .checkov.yml
#
# Documentation:
#   https://www.checkov.io/2.Basics/CLI%20Command%20Reference.html
#   https://www.checkov.io/5.Policy%20Index/terraform.html
#

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Framework and Compliance Standards
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Scan Terraform files
# CIS AWS, PCI-DSS, HIPAA, ISO27001 checks are included in Terraform framework
framework:
  - terraform

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Directory Configuration
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Directories to scan
directory:
  - terraform/atlantis
  - terraform/logging
  - terraform/monitoring
  - terraform/network
  - terraform/kms
  - terraform/secrets
  - terraform/modules

# Exclude specific paths from scanning
skip-path:
  - terraform/.terraform/**
  - terraform/**/.terraform/**
  - terraform/**/test/**
  - terraform/**/examples/**
  - terraform/**/.terraform.lock.hcl
  - "**/*.tfvars"  # Variable files may contain sensitive data patterns that trigger false positives

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Check Configuration
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Checks to skip (use sparingly - document justification)
# Format: CKV_AWS_<number> for AWS checks
skip-check:
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Checkov Bugs / False Positives
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # ALB HTTPS Protocol Check - Checkov dynamic block parsing bug
  # Justification: CKV_AWS_2 fails to parse dynamic redirect blocks in ALB listeners
  # Issue: Checkov tries to access redirect[0] but dynamic blocks use for_each
  # Impact: False positive - actual code properly configures HTTPS redirects
  # Reference: docs/governance/CHECKOV_POLICY_GUIDE.md - Troubleshooting section
  - CKV_AWS_2  # ALB listener protocol HTTPS

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Development Environment - Cost Optimization
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # CloudWatch Log Retention - Cost optimization for non-production
  # Justification: 1-year retention not required for dev/staging environments
  # Impact: Reduces CloudWatch costs significantly
  # Review Date: 2025-07-01
  # Note: Production environments should use 365+ days retention
  - CKV_AWS_338  # CloudWatch log groups retains logs for at least 1 year

  # ALB Access Logging - Not required for development
  # Justification: Access logs generate costs and storage overhead in dev environments
  # Impact: Cost optimization
  # Review Date: 2025-07-01
  # Note: Production environments should enable access logging
  - CKV_AWS_91  # ELBv2 has access logging enabled

  # ALB Deletion Protection - Not required for development
  # Justification: Enables faster infrastructure iteration in dev/staging
  # Impact: Allows easy cleanup and recreation of resources
  # Review Date: 2025-07-01
  # Note: Production environments should enable deletion protection
  - CKV_AWS_150  # Load Balancer has deletion protection enabled

  # S3 Bucket Logging - Cost optimization for temporary buckets
  # Justification: Server access logging generates additional costs
  # Impact: Reduces S3 costs for temporary/non-critical buckets
  # Review Date: 2025-07-01
  - CKV_AWS_18  # S3 bucket server access logging

  # S3 Cross-Region Replication - Not required for development
  # Justification: CRR adds complexity and costs for non-critical data
  # Impact: Cost optimization and simplified infrastructure
  # Review Date: 2025-07-01
  # Note: Production critical data should use CRR
  - CKV_AWS_144  # S3 bucket has cross-region replication enabled

  # S3 KMS Encryption - Default SSE-S3 sufficient for non-sensitive data
  # Justification: KMS adds costs and complexity for non-sensitive buckets
  # Impact: Uses AWS-managed keys (SSE-S3) instead of customer-managed (KMS)
  # Review Date: 2025-07-01
  # Note: Sensitive data buckets should use KMS encryption
  - CKV_AWS_145  # S3 buckets encrypted with KMS by default

  # S3 Event Notifications - Not required for all buckets
  # Justification: Event-driven processing not needed for all storage
  # Impact: Simplifies infrastructure for non-event-driven workflows
  # Review Date: 2025-07-01
  - CKV2_AWS_62  # S3 buckets should have event notifications enabled

  # Secrets Manager KMS Encryption - Default encryption sufficient
  # Justification: Secrets Manager encrypts by default with AWS-managed keys
  # Impact: Cost optimization while maintaining encryption
  # Review Date: 2025-07-01
  # Note: Customer-managed KMS keys add audit trails but increase costs
  - CKV_AWS_149  # Secrets Manager secret encrypted using KMS CMK

  # Secrets Manager Rotation - Not required for development
  # Justification: Manual rotation acceptable in non-production environments
  # Impact: Simplifies secret management in development
  # Review Date: 2025-07-01
  # Note: Production should enable automatic rotation
  - CKV2_AWS_57  # Secrets Manager secrets should have automatic rotation enabled

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Development Environment - Network Configuration
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # Security Group Egress All - Required for internet access
  # Justification: Applications need unrestricted outbound internet access
  # Impact: Allows package downloads, API calls, external integrations
  # Review Date: 2025-07-01
  # Note: Consider restricting in production based on service requirements
  - CKV_AWS_382  # No security groups allow egress from 0.0.0.0:0 to port -1

  # Security Group Ingress HTTP - Required for ALB health checks and HTTP->HTTPS redirect
  # Justification: ALB needs port 80 for redirecting HTTP to HTTPS
  # Impact: Standard web application pattern
  # Review Date: 2025-07-01
  # Note: Traffic is immediately redirected to HTTPS
  - CKV_AWS_260  # No security groups allow ingress from 0.0.0.0:0 to port 80

  # HTTP Protocol - Used for HTTP->HTTPS redirection
  # Justification: HTTP listeners redirect all traffic to HTTPS
  # Impact: Standard security pattern for web applications
  # Review Date: 2025-07-01
  # Note: Actual application traffic uses HTTPS only
  - CKV_AWS_378  # AWS Load Balancer uses HTTP protocol (redirect to HTTPS)

  # ALB Drop HTTP Headers - Not required for internal services
  # Justification: Internal services may need HTTP headers for routing/debugging
  # Impact: Preserves header information for troubleshooting
  # Review Date: 2025-07-01
  - CKV_AWS_131  # ALB drops HTTP headers

  # Security Group Unused - Development iteration
  # Justification: Security groups created during infrastructure development
  # Impact: Allows iterative development without forcing immediate attachment
  # Review Date: 2025-07-01
  # Note: Should be cleaned up periodically
  - CKV2_AWS_5  # Security Groups are attached to another resource

  # VPC Public Subnets - Required for ALB and NAT Gateway
  # Justification: Public subnets needed for internet-facing load balancers
  # Impact: Standard VPC architecture pattern
  # Review Date: 2025-07-01
  - CKV_AWS_130  # VPC subnets do not assign public IP by default

  # VPC Flow Logs - Cost optimization for development
  # Justification: Flow logs generate costs and storage overhead
  # Impact: Cost optimization
  # Review Date: 2025-07-01
  # Note: Production should enable VPC flow logs
  - CKV2_AWS_11  # VPC flow logging enabled in all VPCs

  # Default Security Group - Development flexibility
  # Justification: Default SG may be used during development iteration
  # Impact: Allows faster development iteration
  # Review Date: 2025-07-01
  # Note: Production should restrict default security groups
  - CKV2_AWS_12  # Default security group restricts all traffic

  # ALB HTTP to HTTPS Redirect - Already configured via module
  # Justification: ALB module already implements HTTP->HTTPS redirect
  # Impact: False positive - redirect is configured in ALB listener rules
  # Review Date: 2025-07-01
  - CKV2_AWS_20  # ALB redirects HTTP requests into HTTPS

  # ALB WAF Protection - Cost optimization for development
  # Justification: WAF adds significant costs for non-production environments
  # Impact: Cost optimization (~$5/month per WebACL + rules)
  # Review Date: 2025-07-01
  # Note: Production public-facing ALBs should use WAF
  - CKV2_AWS_28  # Public facing ALB protected by WAF

  # ALB TLS 1.2 Minimum - Compatibility for development
  # Justification: TLS 1.0/1.1 support for legacy client testing
  # Impact: Allows testing with older clients
  # Review Date: 2025-07-01
  # Note: Production should enforce TLS 1.2+
  - CKV_AWS_103  # Load balancer using at least TLS 1.2

  # S3 Public Access Block - Intentional for public assets
  # Justification: Some buckets need public access (e.g., static websites)
  # Impact: Allows public bucket configuration where needed
  # Review Date: 2025-07-01
  # Note: Review each bucket individually
  - CKV2_AWS_6  # S3 bucket has Public Access block

  # S3 Versioning - Cost optimization for temporary data
  # Justification: Versioning adds storage costs for non-critical buckets
  # Impact: Cost optimization
  # Review Date: 2025-07-01
  # Note: Critical data buckets should enable versioning
  - CKV_AWS_21  # S3 bucket versioning enabled

  # S3 Lifecycle Configuration - Not required for all buckets
  # Justification: Manual lifecycle management acceptable for some buckets
  # Impact: Simplifies bucket management
  # Review Date: 2025-07-01
  - CKV2_AWS_61  # S3 bucket has lifecycle configuration

  # S3 Abort Multipart Uploads - Not critical for development
  # Justification: Manual cleanup acceptable in development
  # Impact: Minor cost optimization opportunity
  # Review Date: 2025-07-01
  - CKV_AWS_300  # S3 lifecycle aborts failed uploads

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Development Environment - KMS Encryption (Cost Optimization)
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # CloudWatch Log Group KMS Encryption - Cost optimization
  # Justification: AWS-managed encryption sufficient for non-sensitive logs
  # Impact: Reduces KMS API call costs
  # Review Date: 2025-07-01
  # Note: Sensitive logs should use KMS CMK
  - CKV_AWS_158  # CloudWatch Log Group encrypted by KMS

  # General KMS Encryption - Cost optimization for non-sensitive data
  # Justification: AWS-managed keys sufficient for non-sensitive resources
  # Impact: Reduces KMS costs and complexity
  # Review Date: 2025-07-01
  # Note: Sensitive data should use customer-managed keys
  - CKV_AWS_184  # Resource encrypted by KMS CMK

  # KMS Key Policy - Development simplification
  # Justification: Default KMS key policy sufficient for development
  # Impact: Simplifies key management
  # Review Date: 2025-07-01
  - CKV2_AWS_64  # KMS key Policy is defined

  # SSM Parameter KMS Encryption - Default encryption sufficient
  # Justification: SSM encrypts by default with AWS-managed keys
  # Impact: Cost optimization
  # Review Date: 2025-07-01
  - CKV2_AWS_34  # SSM Parameter should be Encrypted

  # RDS Performance Insights KMS - Cost optimization
  # Justification: AWS-managed encryption sufficient for performance data
  # Impact: Reduces KMS costs
  # Review Date: 2025-07-01
  - CKV_AWS_354  # RDS Performance Insights encrypted using KMS CMK

  # Lambda Environment Variable KMS - Cost optimization
  # Justification: Default Lambda encryption sufficient for non-sensitive vars
  # Impact: Reduces KMS costs
  # Review Date: 2025-07-01
  # Note: Secrets should be in Secrets Manager, not env vars
  - CKV_AWS_173  # Lambda environmental variable encryption

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Development Environment - Lambda Configuration
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # Lambda Concurrent Execution Limit - Not required for development
  # Justification: Concurrency limits not critical in low-traffic dev environments
  # Impact: Simplifies Lambda configuration
  # Review Date: 2025-07-01
  # Note: Production should set appropriate limits
  - CKV_AWS_115  # Lambda function-level concurrent execution limit

  # Lambda Dead Letter Queue - Not required for development
  # Justification: Error tracking acceptable through CloudWatch logs
  # Impact: Simplifies architecture
  # Review Date: 2025-07-01
  # Note: Production critical functions should use DLQ
  - CKV_AWS_116  # Lambda configured for Dead Letter Queue

  # Lambda VPC Configuration - Not required for all functions
  # Justification: Not all functions need VPC access
  # Impact: Reduces cold start times and simplifies networking
  # Review Date: 2025-07-01
  # Note: Functions accessing VPC resources should be in VPC
  - CKV_AWS_117  # Lambda configured inside VPC

  # Lambda X-Ray Tracing - Cost optimization for development
  # Justification: CloudWatch logs sufficient for development debugging
  # Impact: Reduces X-Ray costs
  # Review Date: 2025-07-01
  # Note: Production should enable X-Ray for critical functions
  - CKV_AWS_50  # X-Ray tracing enabled for Lambda

  # Lambda Code Signing - Not required for development
  # Justification: Code signing adds complexity for rapid iteration
  # Impact: Faster development iteration
  # Review Date: 2025-07-01
  # Note: Production should use code signing for security
  - CKV_AWS_272  # Lambda configured to validate code-signing

  # Lambda Permission Constraints - Development flexibility
  # Justification: Broader permissions acceptable in development for testing
  # Impact: Allows easier integration testing
  # Review Date: 2025-07-01
  # Note: Production should restrict permissions by SourceArn/SourceAccount
  - CKV_AWS_364  # Lambda function permissions delegated by SourceArn/SourceAccount

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Development Environment - RDS/Database Configuration
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # RDS Enhanced Monitoring - Cost optimization for development
  # Justification: Basic CloudWatch metrics sufficient for development
  # Impact: Reduces monitoring costs (~$1-2/month per instance)
  # Review Date: 2025-07-01
  # Note: Production should enable enhanced monitoring
  - CKV_AWS_118  # Enhanced monitoring enabled for RDS

  # RDS Log Exports - Cost optimization for development
  # Justification: Log exports add CloudWatch Logs costs
  # Impact: Cost optimization
  # Review Date: 2025-07-01
  # Note: Production should export relevant logs
  - CKV_AWS_129  # RDS logs enabled

  # RDS Multi-AZ - Cost optimization for development
  # Justification: Multi-AZ doubles RDS costs for dev environments
  # Impact: 50% cost reduction for RDS instances
  # Review Date: 2025-07-01
  # Note: Production should use Multi-AZ for high availability
  - CKV_AWS_157  # RDS instances have Multi-AZ enabled

  # RDS Deletion Protection - Development flexibility
  # Justification: Faster iteration by allowing easy cleanup
  # Impact: Allows quick destroy/recreate cycles
  # Review Date: 2025-07-01
  # Note: Production must enable deletion protection
  - CKV_AWS_293  # AWS database instances have deletion protection

  # RDS Performance Insights - Cost optimization for development
  # Justification: Performance Insights adds costs ($0.01/vCPU/hour)
  # Impact: Cost optimization
  # Review Date: 2025-07-01
  # Note: Production should enable for troubleshooting
  - CKV_AWS_353  # RDS instances have performance insights enabled

  # RDS PostgreSQL Query Logging - Performance optimization
  # Justification: Query logging impacts performance in development
  # Impact: Better development database performance
  # Review Date: 2025-07-01
  # Note: Production should enable for audit/troubleshooting
  - CKV2_AWS_30  # Postgres RDS has Query Logging enabled

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Development Environment - Monitoring & Logging
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # CloudTrail SNS Topic - Not required for development
  # Justification: CloudWatch Events sufficient for development monitoring
  # Impact: Simplifies architecture
  # Review Date: 2025-07-01
  # Note: Production should use SNS for real-time alerts
  - CKV_AWS_252  # CloudTrail defines an SNS Topic

  # CloudTrail CloudWatch Integration - Cost optimization
  # Justification: S3 storage sufficient for development audit logs
  # Impact: Reduces CloudWatch Logs costs
  # Review Date: 2025-07-01
  # Note: Production should integrate with CloudWatch for alerting
  - CKV2_AWS_10  # CloudTrail trails integrated with CloudWatch Logs

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Development Environment - Container Registry
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # ECR Image Tag Immutability - Development flexibility
  # Justification: Mutable tags allow overwriting images during development
  # Impact: Faster iteration with same tag names (e.g., "latest", "dev")
  # Review Date: 2025-07-01
  # Note: Production should use immutable tags for reproducibility
  - CKV_AWS_51  # ECR Image Tags are immutable

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Secrets Management
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # Secrets Manager Rotation Period - Development flexibility
  # Justification: 90-day rotation not required for development secrets
  # Impact: Reduces rotation complexity
  # Review Date: 2025-07-01
  # Note: Production should enforce regular rotation schedules
  - CKV_AWS_304  # Secrets Manager secrets rotated within 90 days

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # IAM Policies - TO BE REVIEWED
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  # IAM Wildcard Resource - ⚠️ REQUIRES MANUAL REVIEW
  # Justification: Some AWS services require wildcard permissions (e.g., CloudWatch Logs)
  # Impact: May allow broader permissions than necessary
  # Review Date: 2025-07-01
  # TODO: Review each IAM policy individually to minimize wildcard usage
  # Note: This should be addressed before production deployment
  - CKV_AWS_355  # No IAM policies documents allow "*" as statement's resource

  # IAM Data Exfiltration - ⚠️ REQUIRES MANUAL REVIEW
  # Justification: Some service roles need broad S3/data access for legitimate purposes
  # Impact: May allow unintended data access patterns
  # Review Date: 2025-07-01
  # TODO: Review policies allowing S3:GetObject, S3:ListBucket with broad resources
  # Note: Ensure data access policies follow least privilege principle
  - CKV_AWS_288  # IAM policies does not allow data exfiltration

  # IAM Write Access Constraints - ⚠️ REQUIRES MANUAL REVIEW
  # Justification: Some automation roles need write access across resources
  # Impact: May allow unintended resource modifications
  # Review Date: 2025-07-01
  # TODO: Review policies with broad write permissions (Create*, Put*, Delete*, etc.)
  # Note: Add conditions (MFA, IP, tags) to constrain write operations
  - CKV_AWS_290  # IAM policies does not allow write access without constraints

  # Add skips only with proper justification in comments
  # Review skip rules quarterly to ensure they're still valid

# Soft fail mode - report issues but don't fail pipeline
# Set to false for production enforcement
soft-fail: false

# Compact output format
compact: true

# Quiet mode - reduce verbose output
quiet: false

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Severity and Filtering
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Check severity threshold managed via soft-fail
# Use soft-fail flag with MEDIUM severity in CLI instead
# soft-fail-on: "HIGH,CRITICAL"

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Output Configuration
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Output format: Use CLI flag --output json instead
# output-file-path managed via CLI --output-file-path flag

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Performance and Behavior
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Performance options managed via CLI flags:
# --download-external-modules false (faster scans)
# Use checkov CLI directly for these options

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# External Checks and Plugins
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# External check directories (for custom policies)
# external-checks-dir:
#   - .checkov/custom_checks

# External modules directory
# external-modules-download-path: .external_modules

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Secrets Detection
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Enable secrets scanning (boolean flag, no value needed)
# Note: Use --enable-secret-scan-all-files as CLI flag, not in config

# Secrets scan patterns to skip (reduce false positives)
# skip-secrets-scan:
#   - BC_GIT_1  # Generic Git secrets
#   - BC_GIT_2  # AWS keys

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Metadata and Reporting
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Repo metadata for tracking and reporting
# repo-id: infrastructure
# branch: main

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Policy Enforcement Guidelines
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#
# CRITICAL/HIGH Issues:
#   - Encryption not enabled (S3, RDS, EBS)
#   - Public access exposed (S3, RDS, Security Groups)
#   - Weak IAM policies (overly permissive)
#   - Missing security groups or network controls
#   - Secrets in code or unencrypted
#
# MEDIUM Issues:
#   - Logging not enabled
#   - Versioning not configured
#   - Missing tags
#   - Non-compliant naming
#   - Missing monitoring/alarms
#
# LOW Issues:
#   - Documentation gaps
#   - Best practice recommendations
#   - Optimization suggestions
#
# Alignment with Infrastructure Governance:
#   - Follows docs/governance/infrastructure_governance.md
#   - Complements tfsec checks (.tfsec/config.yml)
#   - Integrates with GitHub Actions governance validators
#
# Related Documentation:
#   - Governance: docs/governance/infrastructure_governance.md
#   - Security Standards: docs/governance/SECURITY_SCAN_REPORT_TEMPLATE.md
#   - Naming Convention: docs/governance/NAMING_CONVENTION.md
#   - Tagging Standards: docs/governance/TAGGING_STANDARDS.md
#
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
